# harm-cli Installation Guide

Complete guide for installing and configuring harm-cli on your system.

---

## 🚀 Quick Installation

### One-Command Install

```bash
./install.sh
```

This interactive script will:

1. ✅ Check all required dependencies
2. ✅ Create symlink in `~/.local/bin`
3. ✅ Ask for your preferred shortcut style
4. ✅ Install shell completions (bash or zsh)
5. ✅ Update your shell config automatically
6. ✅ Test the installation

### Or Use Just

```bash
just install-local
```

---

## ⚙️ Shortcut Styles

When you run `./install.sh`, you'll choose from 4 shortcut styles:

### 1. Minimal - Just Main Alias

```bash
h work start "task"
h goal set "goal" 2h
h ai "question"
```

**Use if:** You want minimal changes to your shell

---

### 2. Balanced - Direct Subcommands (Recommended)

```bash
work start "task"
goal set "goal" 2h
ai "question"
proj switch myapp
```

**Use if:** You want natural, readable commands

---

### 3. Power User - Ultra-Short Shortcuts

```bash
ws "task"     # work start
ww            # work status
wo            # work stop
gs "goal" 2h  # goal set
gg            # goal show
ask "?"       # ai query
```

**Use if:** You prioritize speed over readability

---

### 4. Hybrid - Best of Both (Recommended for Most)

```bash
# Use ultra-short for frequent commands
ws "task"              # work start
ww                     # work status
wo                     # work stop

# Use full names for clarity
goal set "finish API" 3h
ai "how do I...?"
proj switch myapp

# Use 'h' for less common commands
h docker status
h python test
```

**Use if:** You want maximum flexibility

---

## 📦 What Gets Installed

### Files Created

- **Symlink:** `~/.local/bin/harm-cli` → `~/harm-cli/bin/harm-cli`
- **Shell Integration:** Added to `~/.zshrc` or `~/.bashrc`

### Shell Config Additions

Example for **Hybrid** style in `.zshrc`:

```bash
# ═══════════════════════════════════════════════════════════════
# harm-cli: Shell Integration
# Generated by install.sh
# ═══════════════════════════════════════════════════════════════

# harm-cli: Main alias for less common commands
alias h='harm-cli'

# harm-cli: Direct subcommands for frequent use
alias work='harm-cli work'
alias goal='harm-cli goal'
alias ai='harm-cli ai'
alias proj='harm-cli proj'

# harm-cli: Ultra-short work session commands
alias ws='harm-cli work start'
alias wo='harm-cli work stop'
alias ww='harm-cli work status'

# harm-cli: Completions
fpath+=("$HOME/harm-cli/completions")
autoload -Uz compinit && compinit
```

---

## ✅ After Installation

### 1. Reload Your Shell

```bash
source ~/.zshrc
# or restart your terminal
```

### 2. Verify Installation

```bash
which harm-cli
# Output: /Users/harm/.local/bin/harm-cli

harm-cli version
# Output: harm-cli version 1.0.0

harm-cli doctor
# Checks all dependencies
```

### 3. Test Your Shortcuts

```bash
# If you chose Hybrid style:
ws "testing installation"    # Start work session
ww                           # Check status
wo                           # Stop work

# Try other commands
goal set "learn harm-cli" 30m
ai "what are best practices for bash scripts?"
```

### 4. Tab Completion

```bash
harm-cli <TAB>      # Shows all commands
work <TAB>          # Shows: start, stop, status
ai <TAB>            # Shows: query, review, daily, etc.
```

---

## 🗑️ Uninstallation

### Remove harm-cli

```bash
./uninstall.sh
# or
just uninstall-local
```

This will:

- ✅ Remove symlink from `~/.local/bin`
- ✅ Remove shell integration from `.zshrc`
- ✅ **Ask** before removing user data (`~/.harm-cli/`)
- ✅ Create backup of shell config

### Manual Uninstall

If you prefer to remove manually:

```bash
# 1. Remove symlink
rm ~/.local/bin/harm-cli

# 2. Edit ~/.zshrc and remove the harm-cli section
# (between "# harm-cli: Shell Integration" and next blank line)

# 3. Optionally remove user data
rm -rf ~/.harm-cli
```

---

## 🔧 Advanced Configuration

### Change Shortcut Style Later

1. Run uninstall: `./uninstall.sh` (keep data when asked)
2. Run install again: `./install.sh`
3. Choose a different style

### Custom Aliases

Add your own shortcuts to `.zshrc`:

```bash
# Custom harm-cli shortcuts
alias daily='harm-cli ai daily'
alias review='harm-cli ai review'
alias commit='msg=$(harm-cli git commit-msg) && git commit -m "$msg"'
```

### Environment Variables

```bash
# Add to ~/.zshrc for custom configuration
export HARM_CLI_HOME="~/.harm-cli"           # Data directory
export HARM_CLI_LOG_LEVEL="DEBUG"            # Log level
export HARM_CLI_FORMAT="json"                # Default output format
export GEMINI_API_KEY="your-key-here"        # AI features
```

---

## 🆘 Troubleshooting

### "command not found: harm-cli"

**Solution:**

```bash
# Check PATH includes ~/.local/bin
echo $PATH | grep .local/bin

# If not, add to ~/.zshrc:
export PATH="$HOME/.local/bin:$PATH"

# Then reload:
source ~/.zshrc
```

### "command not found: ws" (or other shortcuts)

**Solution:**

```bash
# Reload shell config
source ~/.zshrc

# Verify aliases exist
alias | grep harm
```

### Tab Completion Not Working

**For zsh:**

```bash
# Check fpath includes completions
echo $fpath | grep harm-cli

# If not, add to ~/.zshrc:
fpath+=("$HOME/harm-cli/completions")
autoload -Uz compinit && compinit
```

**For bash:**

```bash
# Add to ~/.bashrc:
source ~/harm-cli/completions/harm-cli.bash
```

### Symlink Broken After `git pull`

This shouldn't happen (symlink is stable), but if it does:

```bash
# Recreate symlink
ln -sf ~/harm-cli/bin/harm-cli ~/.local/bin/harm-cli
```

---

## 📚 Next Steps

After installation:

1. **Read the docs:** `harm-cli help`
2. **Try the features:** See [COMMANDS.md](COMMANDS.md)
3. **Set up AI:** `harm-cli ai --setup`
4. **Start tracking:** `ws "your first task"`

---

## 🎯 Quick Reference

| Task          | Command                                    |
| ------------- | ------------------------------------------ |
| **Install**   | `./install.sh` or `just install-local`     |
| **Uninstall** | `./uninstall.sh` or `just uninstall-local` |
| **Update**    | `cd ~/harm-cli && git pull`                |
| **Verify**    | `harm-cli doctor`                          |
| **Get Help**  | `harm-cli --help`                          |

---

**Questions?** See [README.md](README.md) or run `harm-cli help`
